version: "3.9"

services:
  gen-vpn-keys:
    build: ./services/_gen-vpn-keys
    volumes:
      - ./mounts/_vpn-keys:/data
  bitcoin:
    build: ./services/bitcoin
    depends_on:
      gen-vpn-keys:
        condition: service_completed_successfully
    volumes:
      - ./mounts/bitcoin:/data
    environment:
      INSTALL_VPN: "true"
    profiles: ["bitcoin"]
#  lightning:
#    build: ./services/lightning
#    volumes:
#      - /data:/mounts/lightning
#    environment:
#      INSTALL_VPN: "true"
#    profiles: ["lightning"]
  monero:
    build: ./services/monero
    depends_on:
      gen-vpn-keys:
        condition: service_completed_successfully
    volumes:
      - ./mounts/monero:/data
    environment:
      INSTALL_VPN: "true"
    profiles: ["monero"]
